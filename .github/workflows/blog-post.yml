name: Set recent blog post in README

on:
    schedule:
        - cron: "*/30 * * * *"
    push:
        paths:
            - "scripts/blog-post.sh"
    workflow_dispatch:

jobs:
    update-readme-blog-post:
        name: Update README with latest blog posts
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - name: Run script
              run: bash ./scripts/blog-post.sh || bash ./scripts/send-notification.sh -m "ðŸš¨ Failed to update blog post"
              env:
                    DISCORD_WEBHOK_URI: ${{ secrets.DISCORD_WEBHOK_URI }}
            - name: Commit
              run: bash ./scripts/commit.sh || bash ./scripts/send-notification.sh -m "Failed to commit changes"
              env:
                    TOKEN: ${{ secrets.TOKEN }}
                    REPOSITORY: ${{ github.repository }}
                    DISCORD_WEBHOK_URI: ${{ secrets.DISCORD_WEBHOK_URI }}
                    MESSAGE: "Update blog post"
